# Задача
Существует некоторая система, развернутая внутри chroot окружений. На 10 хостах, используются
различные ОС (RHEL Server release 7.4, Ubuntu 18.04.5 LTS, CentOS Linux release 7.9.2009). Сервис
написан на python 2.7 и для своей работы использует Redis, MySQL (master-master), MySQL Proxy,
Apache, Nginx.\
Для повышения отказоустойчивости, скорости развертывания новых компонентов, руководство
приняло решение о внедрении контейнеризации и перенести эти сервисы в docker контейнеры,
предварительно продумав архитектуру и их взаимодействие.\
Задание поручили вам, опишите, максимально подробно, по шагам, отражая все технические
детали, решение этой задачи.\
Что ожидаем на выходе:
1. Компонентную схему контейнеров, с обоснованием декомпозиции с точки зрения
отказоустойчивости;
2. Описание образов необходимых контейнеров;
3. Подробное описание процесса развертывания на новом хосте\
За исключением python, версиями остального ПО можно пренебречь.


# Решение
Для решения этой задачи, мы будем использовать следующие технологии:

- Docker: для создания и управления контейнерами.
- Docker Compose: для определения и запуска многоконтейнерных приложений.

Описание образов необходимых контейнеров:
- Python 2.7: для работы сервиса.
- Redis: для хранения временных данных.
- MySQL: для хранения основных данных (master-master) (необходима репликация).
- MySQL Proxy: для балансировки нагрузки между мастерами MySQL.
- Apache: для обработки HTTP-запросов.
- Nginx: для обработки HTTPS-запросов.

Компонентная схема контейнеров:
Все указанные выше образы будут запущены в отдельных контейнерах для повышения отказоустойчивости



Описание процесса развертывания на новом хосте:

1: Подготовка нового хоста
Установим Docker на новый хост. 
Это может быть выполнено через официальный репозиторий (Docker hub) или установочный пакет дистрибутива Linux.\
Проверяем, что Docker запущен и работает.

2: Подготовим контейнеры для сервисов
Создаем Docker образы для каждого сервиса.\
Для этого понадобятся Dockerfile для каждого сервиса, описывающие, как собрать образ.\
В Dockerfile каждого сервиса укажем зависимости, такие как Python 2.7, Redis, MySQL, MySQL Proxy, Apache, Nginx.\
Собераем Docker образы для каждого сервиса, используя команду docker build.

3: Создаем Docker сеть и volumes для резервного хранения данных
Создаем Docker сеть для внутреннего взаимодействия между контейнерами.\
Можно использовать команду docker network create.\
Создаем Docker volumes для хранения данных MySQL и Redis в постоянном хранилище.\
Это обеспечит сохранность данных даже при перезапуске контейнеров.

4: Запуск контейнеров
Запускаем контейнеры для каждого сервиса с использованием созданных ранее образов, указав необходимые опции,\
такие как сети, объемы данных, зависимости и переменные окружения.

5: Настройка взаимодействия между сервисами
Настроим контейнеры для взаимодействия друг с другом.\
Например, настраиваем приложения Python 2,7 для подключения к Redis и MySQL, учитывая их адреса и порты в Docker сети.

Шаг 6: Мониторинг и обслуживание
Выбираем тул для миониторинга\
Настраиваем мониторинг для контейнеров и их служб.\
Проверяем работоспособность приложения, убедившись, что оно может получать доступ к необходимым службам, таким как базы данных и прокси-серверы.\
Проверяем, что контейнеры работают корректно и доступны друг другу в созданных Docker сетях средствами мониторинга (zabbix, grafana, prometeus).
